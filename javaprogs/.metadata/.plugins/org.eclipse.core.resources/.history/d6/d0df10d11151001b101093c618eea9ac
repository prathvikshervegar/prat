package see;

import java.io.*;
import java.net.*;
import java.util.*;

public class TCPserver {
private static ServerSocket servsock;
private static final int PORT=12367;
public static void main(String[] args) {
// TODO Auto-generated method stub
System.out.println("opening port....\n");
try
{
servsock=new ServerSocket(PORT);
}
catch(IOException ioEx)
{
System.out.println("Unable to attach to port!");
System.exit(1);
}
do
{
handleClient();
}while(true);
}
private static void handleClient() {
// TODO Auto-generated method stub
Socket link=null;
try
{
link=servsock.accept();
Scanner input=new Scanner(link.getInputStream());
PrintWriter output=new
PrintWriter(link.getOutputStream(),true);
int nummessage=0;
String message=input.nextLine();
while(!message.contentEquals("***CLOSE***"))
{
System.out.println("Message recieved");
nummessage++;
output.println("Message"+nummessage+":"+message);
message=input.nextLine();
}
output.println(nummessage+"messages recieved.");
}
catch(IOException ioEx)
{
ioEx.printStackTrace();
}
finally
{
try
{
System.out.println("\n*closing connection...*");
link.close();
}
catch(IOException ioEx)
{
System.out.println("Unable to disconnect!");
System.exit(1);
}
}
}
}
